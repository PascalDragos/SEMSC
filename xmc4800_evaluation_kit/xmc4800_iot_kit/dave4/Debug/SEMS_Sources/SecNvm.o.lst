   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,2
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "SecNvm.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.write_sec_nvm,"ax",%progbits
  20              	 .align 2
  21              	 .global write_sec_nvm
  22              	 .thumb
  23              	 .thumb_func
  25              	write_sec_nvm:
  26              	.LFB479:
  27              	 .file 1 "../SEMS_Sources/SecNvm.c"
   1:../SEMS_Sources/SecNvm.c **** #include <SEMS_Headers/SecNvM.h>
   2:../SEMS_Sources/SecNvm.c **** #include "../SEMS_Headers/Hash.h"
   3:../SEMS_Sources/SecNvm.c **** #include "../SEMS_Headers/SymEncrypt.h"
   4:../SEMS_Sources/SecNvm.c **** #include "../SEMS_Headers/Skey.h"
   5:../SEMS_Sources/SecNvm.c **** #include "../SEMS_Headers/Config.h"
   6:../SEMS_Sources/SecNvm.c **** #include "../SEMS_Headers/Random.h"
   7:../SEMS_Sources/SecNvm.c **** 
   8:../SEMS_Sources/SecNvm.c **** #include "../SEMS_Headers/Util.h"
   9:../SEMS_Sources/SecNvm.c **** 
  10:../SEMS_Sources/SecNvm.c **** 
  11:../SEMS_Sources/SecNvm.c **** // size <= 128
  12:../SEMS_Sources/SecNvm.c **** uint8_t write_sec_nvm(uint8_t block_id, uint8_t data_buffer[], uint32_t size)
  13:../SEMS_Sources/SecNvm.c **** {
  28              	 .loc 1 13 0
  29              	 .cfi_startproc
  30              	 
  31              	 
  32              	.LVL0:
  33 0000 2DE9F047 	 push {r4,r5,r6,r7,r8,r9,r10,lr}
  34              	.LCFI0:
  35              	 .cfi_def_cfa_offset 32
  36              	 .cfi_offset 4,-32
  37              	 .cfi_offset 5,-28
  38              	 .cfi_offset 6,-24
  39              	 .cfi_offset 7,-20
  40              	 .cfi_offset 8,-16
  41              	 .cfi_offset 9,-12
  42              	 .cfi_offset 10,-8
  43              	 .cfi_offset 14,-4
  14:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_STATUS_t flash_status;
  15:../SEMS_Sources/SecNvm.c **** 	uint8_t data[128] = {0};
  44              	 .loc 1 15 0
  45 0004 8026     	 movs r6,#128
  13:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_STATUS_t flash_status;
  46              	 .loc 1 13 0
  47 0006 C8B0     	 sub sp,sp,#288
  48              	.LCFI1:
  49              	 .cfi_def_cfa_offset 320
  13:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_STATUS_t flash_status;
  50              	 .loc 1 13 0
  51 0008 1746     	 mov r7,r2
  52 000a 8846     	 mov r8,r1
  53              	 .loc 1 15 0
  54 000c 3246     	 mov r2,r6
  55              	.LVL1:
  13:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_STATUS_t flash_status;
  56              	 .loc 1 13 0
  57 000e 0446     	 mov r4,r0
  58              	 .loc 1 15 0
  59 0010 0021     	 movs r1,#0
  60              	.LVL2:
  61 0012 08A8     	 add r0,sp,#32
  62              	.LVL3:
  63 0014 FFF7FEFF 	 bl memset
  64              	.LVL4:
  16:../SEMS_Sources/SecNvm.c **** 	uint8_t key[128] = {10, 20, 30, 40, 50};
  65              	 .loc 1 16 0
  66 0018 3246     	 mov r2,r6
  67 001a 28A8     	 add r0,sp,#160
  68 001c 0021     	 movs r1,#0
  69 001e FFF7FEFF 	 bl memset
  70              	.LVL5:
  17:../SEMS_Sources/SecNvm.c **** 	uint8_t digest[32] = {5, 6, 7};
  71              	 .loc 1 17 0
  72 0022 0025     	 movs r5,#0
  73 0024 4FF0050E 	 mov lr,#5
  18:../SEMS_Sources/SecNvm.c **** 	uint32_t start_addr;
  19:../SEMS_Sources/SecNvm.c **** 
  20:../SEMS_Sources/SecNvm.c **** 	start_addr = block_id * 160;
  74              	 .loc 1 20 0
  75 0028 04EB8404 	 add r4,r4,r4,lsl#2
  16:../SEMS_Sources/SecNvm.c **** 	uint8_t digest[32] = {5, 6, 7};
  76              	 .loc 1 16 0
  77 002c 4FF0140C 	 mov ip,#20
  17:../SEMS_Sources/SecNvm.c **** 	uint8_t digest[32] = {5, 6, 7};
  78              	 .loc 1 17 0
  79 0030 0095     	 str r5,[sp]
  16:../SEMS_Sources/SecNvm.c **** 	uint8_t digest[32] = {5, 6, 7};
  80              	 .loc 1 16 0
  81 0032 3223     	 movs r3,#50
  21:../SEMS_Sources/SecNvm.c **** 
  22:../SEMS_Sources/SecNvm.c **** 	memcpy(data, data_buffer, size);
  82              	 .loc 1 22 0
  83 0034 3A46     	 mov r2,r7
  17:../SEMS_Sources/SecNvm.c **** 	uint32_t start_addr;
  84              	 .loc 1 17 0
  85 0036 0195     	 str r5,[sp,#4]
  86 0038 0295     	 str r5,[sp,#8]
  87 003a 0395     	 str r5,[sp,#12]
  88              	 .loc 1 22 0
  89 003c 4146     	 mov r1,r8
  17:../SEMS_Sources/SecNvm.c **** 	uint32_t start_addr;
  90              	 .loc 1 17 0
  91 003e 0495     	 str r5,[sp,#16]
  92 0040 0595     	 str r5,[sp,#20]
  93 0042 0695     	 str r5,[sp,#24]
  94 0044 0795     	 str r5,[sp,#28]
  95 0046 8DF800E0 	 strb lr,[sp]
  96 004a 4FF0060A 	 mov r10,#6
  97 004e 4FF00709 	 mov r9,#7
  98              	 .loc 1 22 0
  99 0052 08A8     	 add r0,sp,#32
  20:../SEMS_Sources/SecNvm.c **** 
 100              	 .loc 1 20 0
 101 0054 04FA0EF4 	 lsl r4,r4,lr
 102              	.LVL6:
  16:../SEMS_Sources/SecNvm.c **** 	uint8_t digest[32] = {5, 6, 7};
 103              	 .loc 1 16 0
 104 0058 4FF00A08 	 mov r8,#10
 105              	.LVL7:
 106 005c 4FF01E0E 	 mov lr,#30
 107 0060 2825     	 movs r5,#40
 108 0062 8DF8A1C0 	 strb ip,[sp,#161]
 109 0066 8DF8A2E0 	 strb lr,[sp,#162]
 110 006a 8DF8A430 	 strb r3,[sp,#164]
 111 006e 8DF8A350 	 strb r5,[sp,#163]
  17:../SEMS_Sources/SecNvm.c **** 	uint32_t start_addr;
 112              	 .loc 1 17 0
 113 0072 8DF801A0 	 strb r10,[sp,#1]
 114 0076 8DF80290 	 strb r9,[sp,#2]
  16:../SEMS_Sources/SecNvm.c **** 	uint8_t digest[32] = {5, 6, 7};
 115              	 .loc 1 16 0
 116 007a 8DF8A080 	 strb r8,[sp,#160]
 117              	 .loc 1 22 0
 118 007e FFF7FEFF 	 bl memcpy
 119              	.LVL8:
  23:../SEMS_Sources/SecNvm.c **** 
  24:../SEMS_Sources/SecNvm.c **** 	optiga_crypt_random_wrapper(key, sizeof(key));
 120              	 .loc 1 24 0
 121 0082 28A8     	 add r0,sp,#160
 122 0084 3146     	 mov r1,r6
 123 0086 FFF7FEFF 	 bl optiga_crypt_random_wrapper
 124              	.LVL9:
  25:../SEMS_Sources/SecNvm.c **** 	optiga_util_write_shared_key(OPTIGA_NVMKEY_OID, key, sizeof(key));
 125              	 .loc 1 25 0
 126 008a 28A9     	 add r1,sp,#160
 127 008c 3246     	 mov r2,r6
 128 008e 4FF2D810 	 movw r0,#61912
 129 0092 FFF7FEFF 	 bl optiga_util_write_shared_key
 130              	.LVL10:
  26:../SEMS_Sources/SecNvm.c **** 	key[0] = 127;
 131              	 .loc 1 26 0
 132 0096 7F23     	 movs r3,#127
  27:../SEMS_Sources/SecNvm.c **** 	optiga_util_read_shared_key(OPTIGA_NVMKEY_OID, key, sizeof(key));
 133              	 .loc 1 27 0
 134 0098 28A9     	 add r1,sp,#160
 135 009a 3246     	 mov r2,r6
 136 009c 4FF2D810 	 movw r0,#61912
  26:../SEMS_Sources/SecNvm.c **** 	key[0] = 127;
 137              	 .loc 1 26 0
 138 00a0 8DF8A030 	 strb r3,[sp,#160]
 139              	 .loc 1 27 0
 140 00a4 FFF7FEFF 	 bl optiga_util_read_shared_key
 141              	.LVL11:
  28:../SEMS_Sources/SecNvm.c **** 	stream_enc(data, key, sizeof(key));
 142              	 .loc 1 28 0
 143 00a8 08A8     	 add r0,sp,#32
 144 00aa 28A9     	 add r1,sp,#160
 145 00ac 3246     	 mov r2,r6
 146 00ae FFF7FEFF 	 bl stream_enc
 147              	.LVL12:
  29:../SEMS_Sources/SecNvm.c **** 
  30:../SEMS_Sources/SecNvm.c **** 
  31:../SEMS_Sources/SecNvm.c **** 	optiga_crypt_hash_data_wrapper(data, sizeof(data), digest);
  32:../SEMS_Sources/SecNvm.c **** 
  33:../SEMS_Sources/SecNvm.c **** 
  34:../SEMS_Sources/SecNvm.c **** 	// Fill the RAM buffer with the data elements
  35:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_WriteArray(start_addr + 0U, data, size);
 148              	 .loc 1 35 0
 149 00b2 A4B2     	 uxth r4,r4
 150              	.LVL13:
 151 00b4 BDB2     	 uxth r5,r7
  31:../SEMS_Sources/SecNvm.c **** 
 152              	 .loc 1 31 0
 153 00b6 08A8     	 add r0,sp,#32
 154 00b8 3146     	 mov r1,r6
 155 00ba 6A46     	 mov r2,sp
 156 00bc FFF7FEFF 	 bl optiga_crypt_hash_data_wrapper
 157              	.LVL14:
 158              	 .loc 1 35 0
 159 00c0 08A9     	 add r1,sp,#32
 160 00c2 2A46     	 mov r2,r5
 161 00c4 2046     	 mov r0,r4
 162 00c6 FFF7FEFF 	 bl E_EEPROM_XMC4_WriteArray
 163              	.LVL15:
  36:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_WriteArray(start_addr + 128U, digest, size);
 164              	 .loc 1 36 0
 165 00ca A019     	 adds r0,r4,r6
 166 00cc 2A46     	 mov r2,r5
 167 00ce 6946     	 mov r1,sp
 168 00d0 80B2     	 uxth r0,r0
 169 00d2 FFF7FEFF 	 bl E_EEPROM_XMC4_WriteArray
 170              	.LVL16:
  37:../SEMS_Sources/SecNvm.c **** 
  38:../SEMS_Sources/SecNvm.c **** 	// Write the RAM buffer to flash
  39:../SEMS_Sources/SecNvm.c **** 	flash_status = E_EEPROM_XMC4_UpdateFlashContents();
 171              	 .loc 1 39 0
 172 00d6 FFF7FEFF 	 bl E_EEPROM_XMC4_UpdateFlashContents
 173              	.LVL17:
  40:../SEMS_Sources/SecNvm.c **** 
  41:../SEMS_Sources/SecNvm.c **** 	return flash_status;
  42:../SEMS_Sources/SecNvm.c **** }
 174              	 .loc 1 42 0
 175 00da 48B0     	 add sp,sp,#288
 176              	.LCFI2:
 177              	 .cfi_def_cfa_offset 32
 178              	 
 179 00dc BDE8F087 	 pop {r4,r5,r6,r7,r8,r9,r10,pc}
 180              	 .cfi_endproc
 181              	.LFE479:
 183              	 .section .text.read_sec_nvm,"ax",%progbits
 184              	 .align 2
 185              	 .global read_sec_nvm
 186              	 .thumb
 187              	 .thumb_func
 189              	read_sec_nvm:
 190              	.LFB480:
  43:../SEMS_Sources/SecNvm.c **** 
  44:../SEMS_Sources/SecNvm.c **** volatile uint8_t bb;
  45:../SEMS_Sources/SecNvm.c **** uint8_t read_sec_nvm(uint8_t block_id, uint8_t data_buffer[], uint32_t size)
  46:../SEMS_Sources/SecNvm.c **** {
 191              	 .loc 1 46 0
 192              	 .cfi_startproc
 193              	 
 194              	 
 195              	.LVL18:
 196 0000 30B5     	 push {r4,r5,lr}
 197              	.LCFI3:
 198              	 .cfi_def_cfa_offset 12
 199              	 .cfi_offset 4,-12
 200              	 .cfi_offset 5,-8
 201              	 .cfi_offset 14,-4
 202 0002 D3B0     	 sub sp,sp,#332
 203              	.LCFI4:
 204              	 .cfi_def_cfa_offset 344
  47:../SEMS_Sources/SecNvm.c **** 	volatile uint8_t success;
  48:../SEMS_Sources/SecNvm.c **** 	uint8_t block_buffer[160] = {0};
  49:../SEMS_Sources/SecNvm.c **** 	uint8_t digest_calc[32] = {0};
 205              	 .loc 1 49 0
 206 0004 0024     	 movs r4,#0
  48:../SEMS_Sources/SecNvm.c **** 	uint8_t digest_calc[32] = {0};
 207              	 .loc 1 48 0
 208 0006 0021     	 movs r1,#0
 209              	.LVL19:
 210 0008 A022     	 movs r2,#160
 211              	.LVL20:
 212 000a 2AA8     	 add r0,sp,#168
 213              	.LVL21:
 214 000c FFF7FEFF 	 bl memset
 215              	.LVL22:
  50:../SEMS_Sources/SecNvm.c **** 	uint8_t key[128] = {0};
 216              	 .loc 1 50 0
 217 0010 2146     	 mov r1,r4
 218 0012 8022     	 movs r2,#128
 219 0014 0AA8     	 add r0,sp,#40
  49:../SEMS_Sources/SecNvm.c **** 	uint8_t key[128] = {0};
 220              	 .loc 1 49 0
 221 0016 0394     	 str r4,[sp,#12]
 222 0018 0494     	 str r4,[sp,#16]
 223 001a 0594     	 str r4,[sp,#20]
 224 001c 0694     	 str r4,[sp,#24]
 225 001e 0794     	 str r4,[sp,#28]
 226 0020 0894     	 str r4,[sp,#32]
 227 0022 0294     	 str r4,[sp,#8]
 228 0024 0994     	 str r4,[sp,#36]
 229              	 .loc 1 50 0
 230 0026 FFF7FEFF 	 bl memset
 231              	.LVL23:
  51:../SEMS_Sources/SecNvm.c **** 
  52:../SEMS_Sources/SecNvm.c **** 	E_EEPROM_XMC4_ReadArray(0, block_buffer, sizeof(block_buffer));
 232              	 .loc 1 52 0
 233 002a 2046     	 mov r0,r4
 234 002c 2AA9     	 add r1,sp,#168
 235 002e A022     	 movs r2,#160
 236 0030 FFF7FEFF 	 bl E_EEPROM_XMC4_ReadArray
 237              	.LVL24:
  53:../SEMS_Sources/SecNvm.c **** 
  54:../SEMS_Sources/SecNvm.c **** 
  55:../SEMS_Sources/SecNvm.c **** 	optiga_crypt_hash_data_wrapper(block_buffer, sizeof(key), digest_calc);
 238              	 .loc 1 55 0
 239 0034 2AA8     	 add r0,sp,#168
 240 0036 02AA     	 add r2,sp,#8
 241 0038 8021     	 movs r1,#128
 242 003a FFF7FEFF 	 bl optiga_crypt_hash_data_wrapper
 243              	.LVL25:
  56:../SEMS_Sources/SecNvm.c **** 
  57:../SEMS_Sources/SecNvm.c **** 	if(0 == memcmp(digest_calc, block_buffer + 128, sizeof(digest_calc)))
 244              	 .loc 1 57 0
 245 003e 02A8     	 add r0,sp,#8
 246 0040 4AA9     	 add r1,sp,#296
 247 0042 2022     	 movs r2,#32
 248 0044 FFF7FEFF 	 bl memcmp
 249              	.LVL26:
  58:../SEMS_Sources/SecNvm.c **** 	{
  59:../SEMS_Sources/SecNvm.c **** 		success = true;
 250              	 .loc 1 59 0
 251 0048 0DF10705 	 add r5,sp,#7
  57:../SEMS_Sources/SecNvm.c **** 	{
 252              	 .loc 1 57 0
 253 004c 40B1     	 cbz r0,.L8
  60:../SEMS_Sources/SecNvm.c **** 
  61:../SEMS_Sources/SecNvm.c **** 		optiga_util_read_shared_key(OPTIGA_NVMKEY_OID, key, sizeof(key));
  62:../SEMS_Sources/SecNvm.c **** 		stream_enc(block_buffer, key, sizeof(key));
  63:../SEMS_Sources/SecNvm.c **** 
  64:../SEMS_Sources/SecNvm.c **** 	}
  65:../SEMS_Sources/SecNvm.c **** 	else
  66:../SEMS_Sources/SecNvm.c **** 	{
  67:../SEMS_Sources/SecNvm.c **** 		success = false;
 254              	 .loc 1 67 0
 255 004e 8DF80740 	 strb r4,[sp,#7]
 256              	.L5:
  68:../SEMS_Sources/SecNvm.c **** 	}
  69:../SEMS_Sources/SecNvm.c **** 
  70:../SEMS_Sources/SecNvm.c **** 	bb = block_buffer[4];
 257              	 .loc 1 70 0
 258 0052 0A4B     	 ldr r3,.L9
 259 0054 9DF8AC20 	 ldrb r2,[sp,#172]
 260 0058 1A70     	 strb r2,[r3]
  71:../SEMS_Sources/SecNvm.c **** 
  72:../SEMS_Sources/SecNvm.c **** 	return success;
 261              	 .loc 1 72 0
 262 005a 2878     	 ldrb r0,[r5]
  73:../SEMS_Sources/SecNvm.c **** }
 263              	 .loc 1 73 0
 264 005c 53B0     	 add sp,sp,#332
 265              	.LCFI5:
 266              	 .cfi_remember_state
 267              	 .cfi_def_cfa_offset 12
 268              	 
 269 005e 30BD     	 pop {r4,r5,pc}
 270              	.L8:
 271              	.LCFI6:
 272              	 .cfi_restore_state
  59:../SEMS_Sources/SecNvm.c **** 
 273              	 .loc 1 59 0
 274 0060 0123     	 movs r3,#1
  61:../SEMS_Sources/SecNvm.c **** 		stream_enc(block_buffer, key, sizeof(key));
 275              	 .loc 1 61 0
 276 0062 0AA9     	 add r1,sp,#40
 277 0064 4FF2D810 	 movw r0,#61912
 278 0068 8022     	 movs r2,#128
  59:../SEMS_Sources/SecNvm.c **** 
 279              	 .loc 1 59 0
 280 006a 2B70     	 strb r3,[r5]
  61:../SEMS_Sources/SecNvm.c **** 		stream_enc(block_buffer, key, sizeof(key));
 281              	 .loc 1 61 0
 282 006c FFF7FEFF 	 bl optiga_util_read_shared_key
 283              	.LVL27:
  62:../SEMS_Sources/SecNvm.c **** 
 284              	 .loc 1 62 0
 285 0070 2AA8     	 add r0,sp,#168
 286 0072 0AA9     	 add r1,sp,#40
 287 0074 8022     	 movs r2,#128
 288 0076 FFF7FEFF 	 bl stream_enc
 289              	.LVL28:
 290 007a EAE7     	 b .L5
 291              	.L10:
 292              	 .align 2
 293              	.L9:
 294 007c 00000000 	 .word bb
 295              	 .cfi_endproc
 296              	.LFE480:
 298              	 .section .text.write_sec_config,"ax",%progbits
 299              	 .align 2
 300              	 .global write_sec_config
 301              	 .thumb
 302              	 .thumb_func
 304              	write_sec_config:
 305              	.LFB481:
  74:../SEMS_Sources/SecNvm.c **** 
  75:../SEMS_Sources/SecNvm.c **** 
  76:../SEMS_Sources/SecNvm.c **** void write_sec_config(void)
  77:../SEMS_Sources/SecNvm.c **** {
 306              	 .loc 1 77 0
 307              	 .cfi_startproc
 308              	 
 309              	 
 310              	.LVL29:
 311 0000 00B5     	 push {lr}
 312              	.LCFI7:
 313              	 .cfi_def_cfa_offset 4
 314              	 .cfi_offset 14,-4
 315 0002 A3B0     	 sub sp,sp,#140
 316              	.LCFI8:
 317              	 .cfi_def_cfa_offset 144
 318 0004 02A9     	 add r1,sp,#8
 319              	 .loc 1 77 0
 320 0006 0B46     	 mov r3,r1
 321 0008 22A8     	 add r0,sp,#136
 322              	.LVL30:
 323              	.L12:
 324 000a 5A1A     	 subs r2,r3,r1
  78:../SEMS_Sources/SecNvm.c **** 
  79:../SEMS_Sources/SecNvm.c **** 	volatile E_EEPROM_XMC4_STATUS_t flash_status;
  80:../SEMS_Sources/SecNvm.c **** 
  81:../SEMS_Sources/SecNvm.c **** 	uint8_t data_config[128];
  82:../SEMS_Sources/SecNvm.c **** 
  83:../SEMS_Sources/SecNvm.c **** 
  84:../SEMS_Sources/SecNvm.c **** 	uint16_t i;
  85:../SEMS_Sources/SecNvm.c **** 	for(i = 0; i < sizeof(data_config); ++i)
  86:../SEMS_Sources/SecNvm.c **** 	{
  87:../SEMS_Sources/SecNvm.c **** 		data_config[i] = i;
 325              	 .loc 1 87 0 discriminator 3
 326 000c 03F8012B 	 strb r2,[r3],#1
 327              	.LVL31:
  85:../SEMS_Sources/SecNvm.c **** 	{
 328              	 .loc 1 85 0 discriminator 3
 329 0010 8342     	 cmp r3,r0
 330 0012 FAD1     	 bne .L12
  88:../SEMS_Sources/SecNvm.c **** 	}
  89:../SEMS_Sources/SecNvm.c **** 
  90:../SEMS_Sources/SecNvm.c **** 	flash_status = write_sec_nvm(0, data_config, sizeof(data_config));
 331              	 .loc 1 90 0
 332 0014 8022     	 movs r2,#128
 333 0016 0020     	 movs r0,#0
 334 0018 FFF7FEFF 	 bl write_sec_nvm
 335              	.LVL32:
 336 001c 8DF80700 	 strb r0,[sp,#7]
  91:../SEMS_Sources/SecNvm.c **** 	flash_status = flash_status;
 337              	 .loc 1 91 0
 338 0020 9DF80730 	 ldrb r3,[sp,#7]
 339 0024 DBB2     	 uxtb r3,r3
 340 0026 8DF80730 	 strb r3,[sp,#7]
  92:../SEMS_Sources/SecNvm.c **** 
  93:../SEMS_Sources/SecNvm.c **** }
 341              	 .loc 1 93 0
 342 002a 23B0     	 add sp,sp,#140
 343              	.LCFI9:
 344              	 .cfi_def_cfa_offset 4
 345              	 
 346 002c 5DF804FB 	 ldr pc,[sp],#4
 347              	 .cfi_endproc
 348              	.LFE481:
 350              	 .section .text.read_sec_config,"ax",%progbits
 351              	 .align 2
 352              	 .global read_sec_config
 353              	 .thumb
 354              	 .thumb_func
 356              	read_sec_config:
 357              	.LFB482:
  94:../SEMS_Sources/SecNvm.c **** 
  95:../SEMS_Sources/SecNvm.c **** 
  96:../SEMS_Sources/SecNvm.c **** void read_sec_config(void)
  97:../SEMS_Sources/SecNvm.c **** {
 358              	 .loc 1 97 0
 359              	 .cfi_startproc
 360              	 
 361              	 
 362              	.LVL33:
 363 0000 30B5     	 push {r4,r5,lr}
 364              	.LCFI10:
 365              	 .cfi_def_cfa_offset 12
 366              	 .cfi_offset 4,-12
 367              	 .cfi_offset 5,-8
 368              	 .cfi_offset 14,-4
 369 0002 D3B0     	 sub sp,sp,#332
 370              	.LCFI11:
 371              	 .cfi_def_cfa_offset 344
 372              	.LBB4:
 373              	.LBB5:
  49:../SEMS_Sources/SecNvm.c **** 	uint8_t key[128] = {0};
 374              	 .loc 1 49 0
 375 0004 0024     	 movs r4,#0
  48:../SEMS_Sources/SecNvm.c **** 	uint8_t digest_calc[32] = {0};
 376              	 .loc 1 48 0
 377 0006 0021     	 movs r1,#0
 378 0008 A022     	 movs r2,#160
 379 000a 2AA8     	 add r0,sp,#168
 380 000c FFF7FEFF 	 bl memset
 381              	.LVL34:
  50:../SEMS_Sources/SecNvm.c **** 
 382              	 .loc 1 50 0
 383 0010 2146     	 mov r1,r4
 384 0012 8022     	 movs r2,#128
 385 0014 0AA8     	 add r0,sp,#40
  49:../SEMS_Sources/SecNvm.c **** 	uint8_t key[128] = {0};
 386              	 .loc 1 49 0
 387 0016 0394     	 str r4,[sp,#12]
 388 0018 0494     	 str r4,[sp,#16]
 389 001a 0594     	 str r4,[sp,#20]
 390 001c 0694     	 str r4,[sp,#24]
 391 001e 0794     	 str r4,[sp,#28]
 392 0020 0894     	 str r4,[sp,#32]
 393 0022 0294     	 str r4,[sp,#8]
 394 0024 0994     	 str r4,[sp,#36]
  50:../SEMS_Sources/SecNvm.c **** 
 395              	 .loc 1 50 0
 396 0026 FFF7FEFF 	 bl memset
 397              	.LVL35:
  52:../SEMS_Sources/SecNvm.c **** 
 398              	 .loc 1 52 0
 399 002a 2046     	 mov r0,r4
 400 002c 2AA9     	 add r1,sp,#168
 401 002e A022     	 movs r2,#160
 402 0030 FFF7FEFF 	 bl E_EEPROM_XMC4_ReadArray
 403              	.LVL36:
  55:../SEMS_Sources/SecNvm.c **** 
 404              	 .loc 1 55 0
 405 0034 2AA8     	 add r0,sp,#168
 406 0036 02AA     	 add r2,sp,#8
 407 0038 8021     	 movs r1,#128
 408 003a FFF7FEFF 	 bl optiga_crypt_hash_data_wrapper
 409              	.LVL37:
  57:../SEMS_Sources/SecNvm.c **** 	{
 410              	 .loc 1 57 0
 411 003e 02A8     	 add r0,sp,#8
 412 0040 4AA9     	 add r1,sp,#296
 413 0042 2022     	 movs r2,#32
 414 0044 FFF7FEFF 	 bl memcmp
 415              	.LVL38:
  59:../SEMS_Sources/SecNvm.c **** 
 416              	 .loc 1 59 0
 417 0048 0DF10705 	 add r5,sp,#7
  57:../SEMS_Sources/SecNvm.c **** 	{
 418              	 .loc 1 57 0
 419 004c 80B1     	 cbz r0,.L19
  67:../SEMS_Sources/SecNvm.c **** 	}
 420              	 .loc 1 67 0
 421 004e 8DF80740 	 strb r4,[sp,#7]
 422              	.L17:
  70:../SEMS_Sources/SecNvm.c **** 
 423              	 .loc 1 70 0
 424 0052 0E4B     	 ldr r3,.L20
 425 0054 9DF8AC20 	 ldrb r2,[sp,#172]
 426 0058 1A70     	 strb r2,[r3]
  72:../SEMS_Sources/SecNvm.c **** }
 427              	 .loc 1 72 0
 428 005a 2B78     	 ldrb r3,[r5]
 429 005c DBB2     	 uxtb r3,r3
 430              	.LBE5:
 431              	.LBE4:
  98:../SEMS_Sources/SecNvm.c **** 	volatile E_EEPROM_XMC4_STATUS_t flash_status;
  99:../SEMS_Sources/SecNvm.c **** 	uint8_t data_buffer[128];
 100:../SEMS_Sources/SecNvm.c **** 
 101:../SEMS_Sources/SecNvm.c **** 	flash_status = read_sec_nvm(0, data_buffer, sizeof(data_buffer));
 432              	 .loc 1 101 0
 433 005e 8DF8A830 	 strb r3,[sp,#168]
 102:../SEMS_Sources/SecNvm.c **** 	flash_status = flash_status;
 434              	 .loc 1 102 0
 435 0062 9DF8A830 	 ldrb r3,[sp,#168]
 436 0066 DBB2     	 uxtb r3,r3
 437 0068 8DF8A830 	 strb r3,[sp,#168]
 103:../SEMS_Sources/SecNvm.c **** 
 104:../SEMS_Sources/SecNvm.c **** }
 438              	 .loc 1 104 0
 439 006c 53B0     	 add sp,sp,#332
 440              	.LCFI12:
 441              	 .cfi_remember_state
 442              	 .cfi_def_cfa_offset 12
 443              	 
 444 006e 30BD     	 pop {r4,r5,pc}
 445              	.L19:
 446              	.LCFI13:
 447              	 .cfi_restore_state
 448              	.LBB7:
 449              	.LBB6:
  59:../SEMS_Sources/SecNvm.c **** 
 450              	 .loc 1 59 0
 451 0070 0123     	 movs r3,#1
  61:../SEMS_Sources/SecNvm.c **** 		stream_enc(block_buffer, key, sizeof(key));
 452              	 .loc 1 61 0
 453 0072 0AA9     	 add r1,sp,#40
 454 0074 4FF2D810 	 movw r0,#61912
 455 0078 8022     	 movs r2,#128
  59:../SEMS_Sources/SecNvm.c **** 
 456              	 .loc 1 59 0
 457 007a 2B70     	 strb r3,[r5]
  61:../SEMS_Sources/SecNvm.c **** 		stream_enc(block_buffer, key, sizeof(key));
 458              	 .loc 1 61 0
 459 007c FFF7FEFF 	 bl optiga_util_read_shared_key
 460              	.LVL39:
  62:../SEMS_Sources/SecNvm.c **** 
 461              	 .loc 1 62 0
 462 0080 2AA8     	 add r0,sp,#168
 463 0082 0AA9     	 add r1,sp,#40
 464 0084 8022     	 movs r2,#128
 465 0086 FFF7FEFF 	 bl stream_enc
 466              	.LVL40:
 467 008a E2E7     	 b .L17
 468              	.L21:
 469              	 .align 2
 470              	.L20:
 471 008c 00000000 	 .word bb
 472              	.LBE6:
 473              	.LBE7:
 474              	 .cfi_endproc
 475              	.LFE482:
 477              	 .comm bb,1,1
 478              	 .text
 479              	.Letext0:
 480              	 .file 2 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\lib\\gcc\\arm-none-eabi\\4.9.3\\include\\stddef.h"
 481              	 .file 3 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 482              	 .file 4 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 483              	 .file 5 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Infineon/XMC4800_series/Include/XMC4800.h"
 484              	 .file 6 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usic.h"
 485              	 .file 7 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usbd_regs.h"
 486              	 .file 8 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usbd.h"
 487              	 .file 9 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/USBD/usbd.h"
 488              	 .file 10 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/E_EEPROM_XMC4/e_eeprom_xmc4.h"
 489              	 .file 11 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Include/core_cm4.h"
 490              	 .file 12 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Infineon/XMC4800_series/Include/system_XMC4800.h"
 491              	 .file 13 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/USBD/usbd_extern.h"
 492              	 .file 14 "../SEMS_Sources/../SEMS_Headers/Random.h"
 493              	 .file 15 "../SEMS_Sources/../SEMS_Headers/Skey.h"
 494              	 .file 16 "../SEMS_Sources/../SEMS_Headers/SymEncrypt.h"
 495              	 .file 17 "../SEMS_Sources/../SEMS_Headers/Hash.h"
 496              	 .file 18 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\string.h"
DEFINED SYMBOLS
                            *ABS*:00000000 SecNvm.c
    {standard input}:20     .text.write_sec_nvm:00000000 $t
    {standard input}:25     .text.write_sec_nvm:00000000 write_sec_nvm
    {standard input}:184    .text.read_sec_nvm:00000000 $t
    {standard input}:189    .text.read_sec_nvm:00000000 read_sec_nvm
    {standard input}:294    .text.read_sec_nvm:0000007c $d
                            *COM*:00000001 bb
    {standard input}:299    .text.write_sec_config:00000000 $t
    {standard input}:304    .text.write_sec_config:00000000 write_sec_config
    {standard input}:351    .text.read_sec_config:00000000 $t
    {standard input}:356    .text.read_sec_config:00000000 read_sec_config
    {standard input}:471    .text.read_sec_config:0000008c $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
memset
memcpy
optiga_crypt_random_wrapper
optiga_util_write_shared_key
optiga_util_read_shared_key
stream_enc
optiga_crypt_hash_data_wrapper
E_EEPROM_XMC4_WriteArray
E_EEPROM_XMC4_UpdateFlashContents
E_EEPROM_XMC4_ReadArray
memcmp
