   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,2
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "Terminal.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.my_optiga_shell_begin,"ax",%progbits
  20              	 .align 2
  21              	 .global my_optiga_shell_begin
  22              	 .thumb
  23              	 .thumb_func
  25              	my_optiga_shell_begin:
  26              	.LFB449:
  27              	 .file 1 "../SEMS_Sources/Terminal.c"
   1:../SEMS_Sources/Terminal.c **** #include <DAVE.h>
   2:../SEMS_Sources/Terminal.c **** #include "optiga/optiga_crypt.h"
   3:../SEMS_Sources/Terminal.c **** #include "optiga/optiga_util.h"
   4:../SEMS_Sources/Terminal.c **** #include "optiga/common/optiga_lib_logger.h"
   5:../SEMS_Sources/Terminal.c **** #include "optiga/pal/pal_os_event.h"
   6:../SEMS_Sources/Terminal.c **** #include "optiga/pal/pal.h"
   7:../SEMS_Sources/Terminal.c **** #include "optiga/pal/pal_os_timer.h"
   8:../SEMS_Sources/Terminal.c **** #include "optiga/pal/pal_logger.h"
   9:../SEMS_Sources/Terminal.c **** 
  10:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Timer.h"
  11:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Random.h"
  12:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/RSA.h"
  13:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/SymEncrypt.h"
  14:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Unlock.h"
  15:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Com.h"
  16:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Hash.h"
  17:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Patcher.h"
  18:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Config.h"
  19:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Init.h"
  20:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Test.h"
  21:../SEMS_Sources/Terminal.c **** #include "../SEMS_Headers/Decoder.h"
  22:../SEMS_Sources/Terminal.c **** 
  23:../SEMS_Sources/Terminal.c **** extern pal_logger_t logger_console;
  24:../SEMS_Sources/Terminal.c **** 
  25:../SEMS_Sources/Terminal.c **** 
  26:../SEMS_Sources/Terminal.c **** volatile uint8_t failed_req = 0;
  27:../SEMS_Sources/Terminal.c **** volatile uint8_t cooldowned = false;
  28:../SEMS_Sources/Terminal.c **** 
  29:../SEMS_Sources/Terminal.c **** 
  30:../SEMS_Sources/Terminal.c **** void my_optiga_shell_begin(void)
  31:../SEMS_Sources/Terminal.c **** {
  28              	 .loc 1 31 0
  29              	 .cfi_startproc
  30              	 
  31              	 
  32              	.LVL0:
  33 0000 2DE9F04F 	 push {r4,r5,r6,r7,r8,r9,r10,fp,lr}
  34              	.LCFI0:
  35              	 .cfi_def_cfa_offset 36
  36              	 .cfi_offset 4,-36
  37              	 .cfi_offset 5,-32
  38              	 .cfi_offset 6,-28
  39              	 .cfi_offset 7,-24
  40              	 .cfi_offset 8,-20
  41              	 .cfi_offset 9,-16
  42              	 .cfi_offset 10,-12
  43              	 .cfi_offset 11,-8
  44              	 .cfi_offset 14,-4
  45 0004 91B0     	 sub sp,sp,#68
  46              	.LCFI1:
  47              	 .cfi_def_cfa_offset 104
  48 0006 DFF8D491 	 ldr r9,.L20+16
  49 000a DFF8D481 	 ldr r8,.L20+20
  32:../SEMS_Sources/Terminal.c **** 
  33:../SEMS_Sources/Terminal.c **** 	uint8_t sec_unlocked = false;
  34:../SEMS_Sources/Terminal.c **** 	uint8_t sec_comm = false;
  35:../SEMS_Sources/Terminal.c **** 	uint8_t command[32];  // Toate comenzile au 32 de bytes
  36:../SEMS_Sources/Terminal.c **** 
  37:../SEMS_Sources/Terminal.c **** 	init_SEMS();
  50              	 .loc 1 37 0
  51 000e FFF7FEFF 	 bl init_SEMS
  52              	.LVL1:
  34:../SEMS_Sources/Terminal.c **** 	uint8_t command[32];  // Toate comenzile au 32 de bytes
  53              	 .loc 1 34 0
  54 0012 0026     	 movs r6,#0
  38:../SEMS_Sources/Terminal.c **** 
  39:../SEMS_Sources/Terminal.c **** #if LIFECYCLE==TESTING
  40:../SEMS_Sources/Terminal.c **** 	uint8_t is_testing = true;
  41:../SEMS_Sources/Terminal.c **** 	while(is_testing)
  42:../SEMS_Sources/Terminal.c **** 	{
  43:../SEMS_Sources/Terminal.c **** 		test();
  44:../SEMS_Sources/Terminal.c **** 	}
  45:../SEMS_Sources/Terminal.c **** #endif
  46:../SEMS_Sources/Terminal.c **** 
  47:../SEMS_Sources/Terminal.c **** 
  48:../SEMS_Sources/Terminal.c **** 	while(true)
  49:../SEMS_Sources/Terminal.c **** 	{
  50:../SEMS_Sources/Terminal.c **** 
  51:../SEMS_Sources/Terminal.c **** 		// Wrapper for serial read
  52:../SEMS_Sources/Terminal.c **** 		if(0u == read_request(command, sec_unlocked, sec_comm))
  53:../SEMS_Sources/Terminal.c **** 		{
  54:../SEMS_Sources/Terminal.c **** 			// Valid request
  55:../SEMS_Sources/Terminal.c **** 			req_type req_rcv;
  56:../SEMS_Sources/Terminal.c **** 			if(true == cooldowned)
  57:../SEMS_Sources/Terminal.c **** 			{
  58:../SEMS_Sources/Terminal.c **** 				uint8_t buff[32] = "Denied by cooldown.";
  59:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
  60:../SEMS_Sources/Terminal.c **** 				continue;
  61:../SEMS_Sources/Terminal.c **** 			}
  62:../SEMS_Sources/Terminal.c **** 
  63:../SEMS_Sources/Terminal.c **** 			req_rcv = decode_req(command);
  64:../SEMS_Sources/Terminal.c **** 
  65:../SEMS_Sources/Terminal.c **** 			switch(req_rcv){
  66:../SEMS_Sources/Terminal.c **** 				case SEC_UNLOCK:
  67:../SEMS_Sources/Terminal.c **** 				{
  68:../SEMS_Sources/Terminal.c **** 					sec_unlocked = secure_unlock();
  69:../SEMS_Sources/Terminal.c **** 					sec_comm = 0;  // reset sec_comm flag
  70:../SEMS_Sources/Terminal.c **** 					break;
  71:../SEMS_Sources/Terminal.c **** 				}
  72:../SEMS_Sources/Terminal.c **** 				case SEC_COM: // momentan nu pot da 2 cereri de sec com
  73:../SEMS_Sources/Terminal.c **** 				{
  74:../SEMS_Sources/Terminal.c **** 					sec_comm = secure_communication();
  75:../SEMS_Sources/Terminal.c **** 					break;
  76:../SEMS_Sources/Terminal.c **** 				}
  77:../SEMS_Sources/Terminal.c **** 				case SEC_LOCK:
  78:../SEMS_Sources/Terminal.c **** 				{
  79:../SEMS_Sources/Terminal.c **** 					uint8_t buff[32] = "Locked";
  80:../SEMS_Sources/Terminal.c **** 					sec_unlocked = 0;
  81:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
  82:../SEMS_Sources/Terminal.c **** 					break;
  83:../SEMS_Sources/Terminal.c **** 				}
  84:../SEMS_Sources/Terminal.c **** 				case EXAMPLE:
  85:../SEMS_Sources/Terminal.c **** 				{
  86:../SEMS_Sources/Terminal.c **** 					uint8_t buff[32] = "Command response";
  87:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
  88:../SEMS_Sources/Terminal.c **** 					break;
  89:../SEMS_Sources/Terminal.c **** 				}
  90:../SEMS_Sources/Terminal.c **** 				case REQUEST:
  91:../SEMS_Sources/Terminal.c **** 				{
  92:../SEMS_Sources/Terminal.c **** 					uint8_t buff[32] = "Req  response";
  93:../SEMS_Sources/Terminal.c **** 
  94:../SEMS_Sources/Terminal.c **** 					// default behaviour, there would be some processing
  95:../SEMS_Sources/Terminal.c **** 					buff[3] = command[3];
  96:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
  97:../SEMS_Sources/Terminal.c **** 					break;
  98:../SEMS_Sources/Terminal.c **** 				}
  99:../SEMS_Sources/Terminal.c **** 				case UNKNOWN:
 100:../SEMS_Sources/Terminal.c **** 				default:
 101:../SEMS_Sources/Terminal.c **** 				{
 102:../SEMS_Sources/Terminal.c **** 					uint8_t buff[32] = "Unknown request";
 103:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
 104:../SEMS_Sources/Terminal.c **** 					break;
 105:../SEMS_Sources/Terminal.c **** 				}
 106:../SEMS_Sources/Terminal.c **** 			}  // end-switch
 107:../SEMS_Sources/Terminal.c **** 
 108:../SEMS_Sources/Terminal.c **** 		}
 109:../SEMS_Sources/Terminal.c **** 		else
 110:../SEMS_Sources/Terminal.c **** 		{
 111:../SEMS_Sources/Terminal.c **** 			// Req before unlock || invalid Token, Nonce, Hash
 112:../SEMS_Sources/Terminal.c **** 
 113:../SEMS_Sources/Terminal.c **** 			failed_req++;
 114:../SEMS_Sources/Terminal.c **** 			if(true == cooldowned)
  55              	 .loc 1 114 0
  56 0014 CB46     	 mov fp,r9
 113:../SEMS_Sources/Terminal.c **** 			if(true == cooldowned)
  57              	 .loc 1 113 0
  58 0016 C246     	 mov r10,r8
  33:../SEMS_Sources/Terminal.c **** 	uint8_t sec_comm = false;
  59              	 .loc 1 33 0
  60 0018 3746     	 mov r7,r6
  61 001a 08AC     	 add r4,sp,#32
  62              	.LVL2:
  63              	.L2:
  52:../SEMS_Sources/Terminal.c **** 		{
  64              	 .loc 1 52 0
  65 001c 6846     	 mov r0,sp
  66 001e 3946     	 mov r1,r7
  67 0020 3246     	 mov r2,r6
  68 0022 FFF7FEFF 	 bl read_request
  69              	.LVL3:
  70 0026 0546     	 mov r5,r0
  71 0028 0028     	 cmp r0,#0
  72 002a 37D1     	 bne .L3
  73              	.L18:
  74              	.LBB2:
  56:../SEMS_Sources/Terminal.c **** 			{
  75              	 .loc 1 56 0
  76 002c 99F80030 	 ldrb r3,[r9]
  77 0030 012B     	 cmp r3,#1
  78 0032 00F09880 	 beq .L17
  63:../SEMS_Sources/Terminal.c **** 
  79              	 .loc 1 63 0
  80 0036 6846     	 mov r0,sp
  81 0038 FFF7FEFF 	 bl decode_req
  82              	.LVL4:
  65:../SEMS_Sources/Terminal.c **** 				case SEC_UNLOCK:
  83              	 .loc 1 65 0
  84 003c 0428     	 cmp r0,#4
  85 003e 00F2B780 	 bhi .L6
  86 0042 DFE800F0 	 tbb [pc,r0]
  87              	.L8:
  88 0046 7E       	 .byte (.L7-.L8)/2
  89 0047 7A       	 .byte (.L9-.L8)/2
  90 0048 64       	 .byte (.L10-.L8)/2
  91 0049 50       	 .byte (.L11-.L8)/2
  92 004a 03       	 .byte (.L12-.L8)/2
  93 004b 00       	 .p2align 1
  94              	.L12:
  95              	.LBB3:
  92:../SEMS_Sources/Terminal.c **** 
  96              	 .loc 1 92 0
  97 004c 5F4B     	 ldr r3,.L20
  95:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
  98              	 .loc 1 95 0
  99 004e 9DF803E0 	 ldrb lr,[sp,#3]
  92:../SEMS_Sources/Terminal.c **** 
 100              	 .loc 1 92 0
 101 0052 0FCB     	 ldmia r3,{r0,r1,r2,r3}
 102              	.LVL5:
 103 0054 2546     	 mov r5,r4
 104 0056 07C5     	 stmia r5!,{r0,r1,r2}
 105 0058 0022     	 movs r2,#0
  96:../SEMS_Sources/Terminal.c **** 					break;
 106              	 .loc 1 96 0
 107 005a 3146     	 mov r1,r6
 108 005c 2046     	 mov r0,r4
  92:../SEMS_Sources/Terminal.c **** 
 109              	 .loc 1 92 0
 110 005e 2B80     	 strh r3,[r5]
 111 0060 ADF82E20 	 strh r2,[sp,#46]
 112 0064 ADF83020 	 strh r2,[sp,#48]
 113 0068 ADF83220 	 strh r2,[sp,#50]
 114 006c ADF83420 	 strh r2,[sp,#52]
 115 0070 ADF83620 	 strh r2,[sp,#54]
 116 0074 ADF83820 	 strh r2,[sp,#56]
 117 0078 ADF83A20 	 strh r2,[sp,#58]
 118 007c ADF83C20 	 strh r2,[sp,#60]
 119 0080 ADF83E20 	 strh r2,[sp,#62]
  95:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
 120              	 .loc 1 95 0
 121 0084 8DF823E0 	 strb lr,[sp,#35]
  96:../SEMS_Sources/Terminal.c **** 					break;
 122              	 .loc 1 96 0
 123 0088 FFF7FEFF 	 bl write_request
 124              	.LVL6:
 125              	.LBE3:
 126              	.LBE2:
  52:../SEMS_Sources/Terminal.c **** 		{
 127              	 .loc 1 52 0
 128 008c 6846     	 mov r0,sp
 129 008e 3946     	 mov r1,r7
 130 0090 3246     	 mov r2,r6
 131 0092 FFF7FEFF 	 bl read_request
 132              	.LVL7:
 133 0096 0546     	 mov r5,r0
 134 0098 0028     	 cmp r0,#0
 135 009a C7D0     	 beq .L18
 136              	.L3:
 113:../SEMS_Sources/Terminal.c **** 			if(true == cooldowned)
 137              	 .loc 1 113 0
 138 009c 98F80030 	 ldrb r3,[r8]
 139 00a0 0133     	 adds r3,r3,#1
 140 00a2 DBB2     	 uxtb r3,r3
 141 00a4 88F80030 	 strb r3,[r8]
 142              	 .loc 1 114 0
 143 00a8 99F80030 	 ldrb r3,[r9]
 144 00ac 012B     	 cmp r3,#1
 145 00ae 6DD0     	 beq .L19
 115:../SEMS_Sources/Terminal.c **** 			{
 116:../SEMS_Sources/Terminal.c **** 				uint8_t buff[32] = "Denied by cooldown.";
 117:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
 118:../SEMS_Sources/Terminal.c **** 			}
 119:../SEMS_Sources/Terminal.c **** 			else
 120:../SEMS_Sources/Terminal.c **** 			{
 121:../SEMS_Sources/Terminal.c **** 				if(failed_req >= MAX_FAILED_REQ)
 146              	 .loc 1 121 0
 147 00b0 9AF80030 	 ldrb r3,[r10]
 148 00b4 03F0FF05 	 and r5,r3,#255
 149 00b8 002B     	 cmp r3,#0
 150 00ba 47D0     	 beq .L14
 151              	.LBB8:
 122:../SEMS_Sources/Terminal.c **** 				{
 123:../SEMS_Sources/Terminal.c **** 					uint8_t buff[32] = "Cooldown activated.";
 152              	 .loc 1 123 0 discriminator 8
 153 00bc DFF824E1 	 ldr lr,.L20+24
 154 00c0 BEE80F00 	 ldmia lr!,{r0,r1,r2,r3}
 155 00c4 2546     	 mov r5,r4
 156 00c6 0FC5     	 stmia r5!,{r0,r1,r2,r3}
 157 00c8 DEF80030 	 ldr r3,[lr]
 158 00cc 2B60     	 str r3,[r5]
 124:../SEMS_Sources/Terminal.c **** 					optiga_lib_print_bytes(buff, 32);
 159              	 .loc 1 124 0 discriminator 8
 160 00ce 2046     	 mov r0,r4
 123:../SEMS_Sources/Terminal.c **** 					optiga_lib_print_bytes(buff, 32);
 161              	 .loc 1 123 0 discriminator 8
 162 00d0 0023     	 movs r3,#0
 163              	 .loc 1 124 0 discriminator 8
 164 00d2 2021     	 movs r1,#32
 123:../SEMS_Sources/Terminal.c **** 					optiga_lib_print_bytes(buff, 32);
 165              	 .loc 1 123 0 discriminator 8
 166 00d4 0D93     	 str r3,[sp,#52]
 167 00d6 0E93     	 str r3,[sp,#56]
 168 00d8 0F93     	 str r3,[sp,#60]
 169              	 .loc 1 124 0 discriminator 8
 170 00da FFF7FEFF 	 bl optiga_lib_print_bytes
 171              	.LVL8:
 125:../SEMS_Sources/Terminal.c **** 					cooldowned = true;
 172              	 .loc 1 125 0 discriminator 8
 173 00de 0123     	 movs r3,#1
 174 00e0 8BF80030 	 strb r3,[fp]
 175              	.LBE8:
 176 00e4 9AE7     	 b .L2
 177              	.LVL9:
 178              	.L11:
 179              	.LBB9:
 180              	.LBB4:
  86:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
 181              	 .loc 1 86 0
 182 00e6 DFF800E1 	 ldr lr,.L20+28
 183 00ea BEE80F00 	 ldmia lr!,{r0,r1,r2,r3}
 184              	.LVL10:
 185 00ee 2546     	 mov r5,r4
 186 00f0 0FC5     	 stmia r5!,{r0,r1,r2,r3}
 187 00f2 DEF80030 	 ldr r3,[lr]
 188 00f6 2B70     	 strb r3,[r5]
 189 00f8 0DF13100 	 add r0,sp,#49
 190 00fc 0021     	 movs r1,#0
 191 00fe 0F22     	 movs r2,#15
 192 0100 FFF7FEFF 	 bl memset
 193              	.LVL11:
  87:../SEMS_Sources/Terminal.c **** 					break;
 194              	 .loc 1 87 0
 195 0104 2046     	 mov r0,r4
 196 0106 3146     	 mov r1,r6
 197 0108 FFF7FEFF 	 bl write_request
 198              	.LVL12:
 199 010c 86E7     	 b .L2
 200              	.LVL13:
 201              	.L10:
 202              	.LBE4:
 203              	.LBB5:
  79:../SEMS_Sources/Terminal.c **** 					sec_unlocked = 0;
 204              	 .loc 1 79 0
 205 010e 304B     	 ldr r3,.L20+4
 206 0110 93E80300 	 ldmia r3,{r0,r1}
 207              	.LVL14:
 208 0114 1922     	 movs r2,#25
 209 0116 0B0C     	 lsrs r3,r1,#16
 210 0118 2060     	 str r0,[r4]
 211 011a ADF82410 	 strh r1,[sp,#36]
 212 011e 0DF12700 	 add r0,sp,#39
 213 0122 0021     	 movs r1,#0
  81:../SEMS_Sources/Terminal.c **** 					break;
 214              	 .loc 1 81 0
 215 0124 08AC     	 add r4,sp,#32
  79:../SEMS_Sources/Terminal.c **** 					sec_unlocked = 0;
 216              	 .loc 1 79 0
 217 0126 8DF82630 	 strb r3,[sp,#38]
 218 012a FFF7FEFF 	 bl memset
 219              	.LVL15:
  81:../SEMS_Sources/Terminal.c **** 					break;
 220              	 .loc 1 81 0
 221 012e 2046     	 mov r0,r4
 222 0130 3146     	 mov r1,r6
 223 0132 FFF7FEFF 	 bl write_request
 224              	.LVL16:
  80:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
 225              	 .loc 1 80 0
 226 0136 0027     	 movs r7,#0
 227 0138 70E7     	 b .L2
 228              	.LVL17:
 229              	.L9:
 230              	.LBE5:
  74:../SEMS_Sources/Terminal.c **** 					break;
 231              	 .loc 1 74 0
 232 013a FFF7FEFF 	 bl secure_communication
 233              	.LVL18:
 234 013e 0646     	 mov r6,r0
 235              	.LVL19:
  75:../SEMS_Sources/Terminal.c **** 				}
 236              	 .loc 1 75 0
 237 0140 6CE7     	 b .L2
 238              	.LVL20:
 239              	.L7:
  68:../SEMS_Sources/Terminal.c **** 					sec_comm = 0;  // reset sec_comm flag
 240              	 .loc 1 68 0
 241 0142 FFF7FEFF 	 bl secure_unlock
 242              	.LVL21:
  69:../SEMS_Sources/Terminal.c **** 					break;
 243              	 .loc 1 69 0
 244 0146 0026     	 movs r6,#0
 245              	.LVL22:
  68:../SEMS_Sources/Terminal.c **** 					sec_comm = 0;  // reset sec_comm flag
 246              	 .loc 1 68 0
 247 0148 0746     	 mov r7,r0
 248              	.LVL23:
  70:../SEMS_Sources/Terminal.c **** 				}
 249              	 .loc 1 70 0
 250 014a 67E7     	 b .L2
 251              	.LVL24:
 252              	.L14:
 253              	.LBE9:
 254              	.LBB10:
 126:../SEMS_Sources/Terminal.c **** 				}
 127:../SEMS_Sources/Terminal.c **** 				else
 128:../SEMS_Sources/Terminal.c **** 				{
 129:../SEMS_Sources/Terminal.c **** 					// Just a wrong request
 130:../SEMS_Sources/Terminal.c **** 					uint8_t buff[32] = "Request denied.";
 255              	 .loc 1 130 0 discriminator 9
 256 014c 214B     	 ldr r3,.L20+8
 257 014e 0C95     	 str r5,[sp,#48]
 258 0150 0FCB     	 ldmia r3,{r0,r1,r2,r3}
 259 0152 84E80F00 	 stmia r4,{r0,r1,r2,r3}
 131:../SEMS_Sources/Terminal.c **** 					optiga_lib_print_bytes(buff, 32);
 260              	 .loc 1 131 0 discriminator 9
 261 0156 2046     	 mov r0,r4
 262 0158 2021     	 movs r1,#32
 130:../SEMS_Sources/Terminal.c **** 					optiga_lib_print_bytes(buff, 32);
 263              	 .loc 1 130 0 discriminator 9
 264 015a 0D95     	 str r5,[sp,#52]
 265 015c 0E95     	 str r5,[sp,#56]
 266 015e 0F95     	 str r5,[sp,#60]
 267              	 .loc 1 131 0 discriminator 9
 268 0160 FFF7FEFF 	 bl optiga_lib_print_bytes
 269              	.LVL25:
 270 0164 5AE7     	 b .L2
 271              	.L17:
 272              	.LBE10:
 273              	.LBB11:
 274              	.LBB6:
  58:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
 275              	 .loc 1 58 0
 276 0166 DFF884C0 	 ldr ip,.L20+32
 277 016a 0D90     	 str r0,[sp,#52]
 278 016c BCE80F00 	 ldmia ip!,{r0,r1,r2,r3}
 279 0170 A646     	 mov lr,r4
 280 0172 AEE80F00 	 stmia lr!,{r0,r1,r2,r3}
 281 0176 DCF80030 	 ldr r3,[ip]
 282 017a 0E95     	 str r5,[sp,#56]
  59:../SEMS_Sources/Terminal.c **** 				continue;
 283              	 .loc 1 59 0
 284 017c 2046     	 mov r0,r4
 285 017e 2021     	 movs r1,#32
  58:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
 286              	 .loc 1 58 0
 287 0180 0F95     	 str r5,[sp,#60]
 288 0182 CEF80030 	 str r3,[lr]
  59:../SEMS_Sources/Terminal.c **** 				continue;
 289              	 .loc 1 59 0
 290 0186 FFF7FEFF 	 bl optiga_lib_print_bytes
 291              	.LVL26:
 292 018a 47E7     	 b .L2
 293              	.L19:
 294              	.LBE6:
 295              	.LBE11:
 296              	.LBB12:
 116:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
 297              	 .loc 1 116 0 discriminator 7
 298 018c DFF85CE0 	 ldr lr,.L20+32
 299 0190 BEE80F00 	 ldmia lr!,{r0,r1,r2,r3}
 300 0194 2546     	 mov r5,r4
 301 0196 0FC5     	 stmia r5!,{r0,r1,r2,r3}
 302 0198 DEF80030 	 ldr r3,[lr]
 303 019c 2B60     	 str r3,[r5]
 117:../SEMS_Sources/Terminal.c **** 			}
 304              	 .loc 1 117 0 discriminator 7
 305 019e 2046     	 mov r0,r4
 116:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
 306              	 .loc 1 116 0 discriminator 7
 307 01a0 0023     	 movs r3,#0
 117:../SEMS_Sources/Terminal.c **** 			}
 308              	 .loc 1 117 0 discriminator 7
 309 01a2 2021     	 movs r1,#32
 116:../SEMS_Sources/Terminal.c **** 				optiga_lib_print_bytes(buff, 32);
 310              	 .loc 1 116 0 discriminator 7
 311 01a4 0D93     	 str r3,[sp,#52]
 312 01a6 0E93     	 str r3,[sp,#56]
 313 01a8 0F93     	 str r3,[sp,#60]
 117:../SEMS_Sources/Terminal.c **** 			}
 314              	 .loc 1 117 0 discriminator 7
 315 01aa FFF7FEFF 	 bl optiga_lib_print_bytes
 316              	.LVL27:
 317              	.LBE12:
 318 01ae 35E7     	 b .L2
 319              	.LVL28:
 320              	.L6:
 321              	.LBB13:
 322              	.LBB7:
 102:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
 323              	 .loc 1 102 0
 324 01b0 094B     	 ldr r3,.L20+12
 325 01b2 0FCB     	 ldmia r3,{r0,r1,r2,r3}
 326              	.LVL29:
 327 01b4 84E80F00 	 stmia r4,{r0,r1,r2,r3}
 328 01b8 0023     	 movs r3,#0
 103:../SEMS_Sources/Terminal.c **** 					break;
 329              	 .loc 1 103 0
 330 01ba 2046     	 mov r0,r4
 331 01bc 3146     	 mov r1,r6
 102:../SEMS_Sources/Terminal.c **** 					write_request(buff, sec_comm);
 332              	 .loc 1 102 0
 333 01be 0C93     	 str r3,[sp,#48]
 334 01c0 0D93     	 str r3,[sp,#52]
 335 01c2 0E93     	 str r3,[sp,#56]
 336 01c4 0F93     	 str r3,[sp,#60]
 103:../SEMS_Sources/Terminal.c **** 					break;
 337              	 .loc 1 103 0
 338 01c6 FFF7FEFF 	 bl write_request
 339              	.LVL30:
 340 01ca 27E7     	 b .L2
 341              	.L21:
 342              	 .align 2
 343              	.L20:
 344 01cc 60000000 	 .word .LANCHOR1+96
 345 01d0 20000000 	 .word .LANCHOR1+32
 346 01d4 C0000000 	 .word .LANCHOR1+192
 347 01d8 80000000 	 .word .LANCHOR1+128
 348 01dc 00000000 	 .word .LANCHOR0
 349 01e0 00000000 	 .word .LANCHOR2
 350 01e4 A0000000 	 .word .LANCHOR1+160
 351 01e8 40000000 	 .word .LANCHOR1+64
 352 01ec 00000000 	 .word .LANCHOR1
 353              	.LBE7:
 354              	.LBE13:
 355              	 .cfi_endproc
 356              	.LFE449:
 358              	 .global cooldowned
 359              	 .global failed_req
 360              	 .section .rodata
 361              	 .align 2
 362              	 .set .LANCHOR1,.+0
 363              	.LC0:
 364 0000 44656E69 	 .ascii "Denied by cooldown.\000"
 364      65642062 
 364      7920636F 
 364      6F6C646F 
 364      776E2E00 
 365 0014 00000000 	 .space 12
 365      00000000 
 365      00000000 
 366              	.LC1:
 367 0020 4C6F636B 	 .ascii "Locked\000"
 367      656400
 368 0027 00000000 	 .space 25
 368      00000000 
 368      00000000 
 368      00000000 
 368      00000000 
 369              	.LC2:
 370 0040 436F6D6D 	 .ascii "Command response\000"
 370      616E6420 
 370      72657370 
 370      6F6E7365 
 370      00
 371 0051 00000000 	 .space 15
 371      00000000 
 371      00000000 
 371      000000
 372              	.LC3:
 373 0060 52657120 	 .ascii "Req  response\000"
 373      20726573 
 373      706F6E73 
 373      6500
 374 006e 00000000 	 .space 18
 374      00000000 
 374      00000000 
 374      00000000 
 374      0000
 375              	.LC4:
 376 0080 556E6B6E 	 .ascii "Unknown request\000"
 376      6F776E20 
 376      72657175 
 376      65737400 
 377 0090 00000000 	 .space 16
 377      00000000 
 377      00000000 
 377      00000000 
 378              	.LC5:
 379 00a0 436F6F6C 	 .ascii "Cooldown activated.\000"
 379      646F776E 
 379      20616374 
 379      69766174 
 379      65642E00 
 380 00b4 00000000 	 .space 12
 380      00000000 
 380      00000000 
 381              	.LC6:
 382 00c0 52657175 	 .ascii "Request denied.\000"
 382      65737420 
 382      64656E69 
 382      65642E00 
 383 00d0 00000000 	 .space 16
 383      00000000 
 383      00000000 
 383      00000000 
 384              	 .section .bss.failed_req,"aw",%nobits
 385              	 .set .LANCHOR2,.+0
 388              	failed_req:
 389 0000 00       	 .space 1
 390              	 .section .bss.cooldowned,"aw",%nobits
 391              	 .set .LANCHOR0,.+0
 394              	cooldowned:
 395 0000 00       	 .space 1
 396              	 .text
 397              	.Letext0:
 398              	 .file 2 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 399              	 .file 3 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 400              	 .file 4 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Infineon/XMC4800_series/Include/XMC4800.h"
 401              	 .file 5 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usic.h"
 402              	 .file 6 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usbd_regs.h"
 403              	 .file 7 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usbd.h"
 404              	 .file 8 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/USBD/usbd.h"
 405              	 .file 9 "../SEMS_Sources/../SEMS_Headers/Decoder.h"
 406              	 .file 10 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Include/core_cm4.h"
 407              	 .file 11 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Infineon/XMC4800_series/Include/system_XMC4800.h"
 408              	 .file 12 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/USBD/usbd_extern.h"
 409              	 .file 13 "../SEMS_Sources/../SEMS_Headers/Patcher.h"
 410              	 .file 14 "../SEMS_Sources/../SEMS_Headers/Com.h"
 411              	 .file 15 "../SEMS_Sources/../SEMS_Headers/Unlock.h"
 412              	 .file 16 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/optiga-trust-m/optiga/include/optiga/common/optiga_lib_logger.h"
 413              	 .file 17 "../SEMS_Sources/../SEMS_Headers/Init.h"
DEFINED SYMBOLS
                            *ABS*:00000000 Terminal.c
    {standard input}:20     .text.my_optiga_shell_begin:00000000 $t
    {standard input}:25     .text.my_optiga_shell_begin:00000000 my_optiga_shell_begin
    {standard input}:88     .text.my_optiga_shell_begin:00000046 $d
    {standard input}:344    .text.my_optiga_shell_begin:000001cc $d
    {standard input}:394    .bss.cooldowned:00000000 cooldowned
    {standard input}:388    .bss.failed_req:00000000 failed_req
    {standard input}:361    .rodata:00000000 $d
    {standard input}:389    .bss.failed_req:00000000 $d
    {standard input}:395    .bss.cooldowned:00000000 $d
                     .debug_frame:00000010 $d
    {standard input}:93     .text.my_optiga_shell_begin:0000004b $d
    {standard input}:93     .text.my_optiga_shell_begin:0000004c $t

UNDEFINED SYMBOLS
init_SEMS
read_request
decode_req
write_request
optiga_lib_print_bytes
memset
secure_communication
secure_unlock
