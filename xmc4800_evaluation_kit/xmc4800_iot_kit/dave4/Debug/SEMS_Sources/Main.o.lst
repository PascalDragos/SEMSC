   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,2
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "Main.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.my_optiga_shell_begin,"ax",%progbits
  20              	 .align 2
  21              	 .global my_optiga_shell_begin
  22              	 .thumb
  23              	 .thumb_func
  25              	my_optiga_shell_begin:
  26              	.LFB454:
  27              	 .file 1 "../SEMS_Sources/Main.c"
   1:../SEMS_Sources/Main.c **** #include <DAVE.h>
   2:../SEMS_Sources/Main.c **** #include "optiga/optiga_crypt.h"
   3:../SEMS_Sources/Main.c **** #include "optiga/optiga_util.h"
   4:../SEMS_Sources/Main.c **** #include "optiga/common/optiga_lib_logger.h"
   5:../SEMS_Sources/Main.c **** #include "optiga/pal/pal_os_event.h"
   6:../SEMS_Sources/Main.c **** #include "optiga/pal/pal.h"
   7:../SEMS_Sources/Main.c **** #include "optiga/pal/pal_os_timer.h"
   8:../SEMS_Sources/Main.c **** #include "optiga_example.h"
   9:../SEMS_Sources/Main.c **** #include "optiga/pal/pal_logger.h"
  10:../SEMS_Sources/Main.c **** 
  11:../SEMS_Sources/Main.c **** 
  12:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Timer.h"
  13:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Random.h"
  14:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/RSA.h"
  15:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/SymEncrypt.h"
  16:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Unlock.h"
  17:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Com.h"
  18:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Hash.h"
  19:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Patcher.h"
  20:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Config.h"
  21:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Init.h"
  22:../SEMS_Sources/Main.c **** #include "../SEMS_Headers/Test.h"
  23:../SEMS_Sources/Main.c **** 
  24:../SEMS_Sources/Main.c **** 
  25:../SEMS_Sources/Main.c **** extern pal_logger_t logger_console;
  26:../SEMS_Sources/Main.c **** 
  27:../SEMS_Sources/Main.c **** 
  28:../SEMS_Sources/Main.c **** 
  29:../SEMS_Sources/Main.c **** volatile uint8_t failed_req = 0;
  30:../SEMS_Sources/Main.c **** volatile uint8_t cooldowned = false;
  31:../SEMS_Sources/Main.c **** 
  32:../SEMS_Sources/Main.c **** 
  33:../SEMS_Sources/Main.c **** void my_optiga_shell_begin(void)
  34:../SEMS_Sources/Main.c **** {
  28              	 .loc 1 34 0
  29              	 .cfi_startproc
  30              	 
  31              	 
  32              	.LVL0:
  33 0000 2DE9F04F 	 push {r4,r5,r6,r7,r8,r9,r10,fp,lr}
  34              	.LCFI0:
  35              	 .cfi_def_cfa_offset 36
  36              	 .cfi_offset 4,-36
  37              	 .cfi_offset 5,-32
  38              	 .cfi_offset 6,-28
  39              	 .cfi_offset 7,-24
  40              	 .cfi_offset 8,-20
  41              	 .cfi_offset 9,-16
  42              	 .cfi_offset 10,-12
  43              	 .cfi_offset 11,-8
  44              	 .cfi_offset 14,-4
  45 0004 91B0     	 sub sp,sp,#68
  46              	.LCFI1:
  47              	 .cfi_def_cfa_offset 104
  35:../SEMS_Sources/Main.c **** 
  36:../SEMS_Sources/Main.c **** 	uint8_t sec_unlocked = false;
  37:../SEMS_Sources/Main.c **** 	uint8_t sec_comm = false;
  38:../SEMS_Sources/Main.c **** 
  39:../SEMS_Sources/Main.c **** 	// Toate comenzile au 32 de bytes
  40:../SEMS_Sources/Main.c **** 	uint8_t command[32];
  41:../SEMS_Sources/Main.c **** 
  42:../SEMS_Sources/Main.c **** #if LIFECYCLE==TESTING
  43:../SEMS_Sources/Main.c **** 	uint8_t is_testing = true;
  44:../SEMS_Sources/Main.c **** 	while(is_testing)
  45:../SEMS_Sources/Main.c **** 	{
  46:../SEMS_Sources/Main.c **** 		testing();
  47:../SEMS_Sources/Main.c **** 	}
  48:../SEMS_Sources/Main.c **** #endif
  49:../SEMS_Sources/Main.c **** 
  50:../SEMS_Sources/Main.c **** 	start_cooldown_timer();
  48              	 .loc 1 50 0
  49 0006 FFF7FEFF 	 bl start_cooldown_timer
  50              	.LVL1:
  51 000a DFF89881 	 ldr r8,.L22+16
  52 000e 614B     	 ldr r3,.L22
  53 0010 DFF88491 	 ldr r9,.L22+4
  37:../SEMS_Sources/Main.c **** 
  54              	 .loc 1 37 0
  55 0014 0026     	 movs r6,#0
  56 0016 03F1400A 	 add r10,r3,#64
  51:../SEMS_Sources/Main.c **** 
  52:../SEMS_Sources/Main.c **** 	while(true)
  53:../SEMS_Sources/Main.c **** 	{
  54:../SEMS_Sources/Main.c **** 
  55:../SEMS_Sources/Main.c **** 		// Wrapper for serial read
  56:../SEMS_Sources/Main.c **** 		if(0 == read_request(command, sec_unlocked, sec_comm))
  57:../SEMS_Sources/Main.c **** 		{
  58:../SEMS_Sources/Main.c **** 			if(true == cooldowned)
  59:../SEMS_Sources/Main.c **** 			{
  60:../SEMS_Sources/Main.c **** 				uint8_t buff[32] = {"Denied by cooldown."};
  61:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
  62:../SEMS_Sources/Main.c **** 				continue;
  63:../SEMS_Sources/Main.c **** 			}
  64:../SEMS_Sources/Main.c **** 
  65:../SEMS_Sources/Main.c **** 			// Activate secure unlock
  66:../SEMS_Sources/Main.c **** 			if(command[0] == 'U')
  67:../SEMS_Sources/Main.c **** 			{
  68:../SEMS_Sources/Main.c **** 
  69:../SEMS_Sources/Main.c **** 				sec_unlocked = secure_unlock();
  70:../SEMS_Sources/Main.c **** 				sec_comm = 0;  // reset sec_comm flag
  71:../SEMS_Sources/Main.c **** 				continue;
  72:../SEMS_Sources/Main.c **** 			}
  73:../SEMS_Sources/Main.c **** 
  74:../SEMS_Sources/Main.c **** 
  75:../SEMS_Sources/Main.c **** 			// Activate secure communication
  76:../SEMS_Sources/Main.c **** 			if(command[0] == 'C') // momentatn nu pot da 2 cereri de sec com
  77:../SEMS_Sources/Main.c **** 			{
  78:../SEMS_Sources/Main.c **** 				sec_comm = secure_communication();
  79:../SEMS_Sources/Main.c **** 				continue;
  80:../SEMS_Sources/Main.c **** 			}
  81:../SEMS_Sources/Main.c **** 
  82:../SEMS_Sources/Main.c **** 
  83:../SEMS_Sources/Main.c **** 			// Lock
  84:../SEMS_Sources/Main.c **** 			if(command[0] == 'L')
  85:../SEMS_Sources/Main.c **** 			{
  86:../SEMS_Sources/Main.c **** 				uint8_t buff[32] = {"Locked"};
  87:../SEMS_Sources/Main.c **** 
  88:../SEMS_Sources/Main.c **** 				sec_unlocked = 0;
  89:../SEMS_Sources/Main.c **** 
  90:../SEMS_Sources/Main.c **** 				write_request(buff, sec_comm);
  91:../SEMS_Sources/Main.c **** 				continue;
  92:../SEMS_Sources/Main.c **** 			}
  93:../SEMS_Sources/Main.c **** 
  94:../SEMS_Sources/Main.c **** 			// Usual command
  95:../SEMS_Sources/Main.c **** 			if(command[0] == 'A')
  96:../SEMS_Sources/Main.c **** 			{
  97:../SEMS_Sources/Main.c **** 				uint8_t buff[32] = {"AABBCCDEFG"};
  98:../SEMS_Sources/Main.c **** 				write_request(buff, sec_comm);
  99:../SEMS_Sources/Main.c **** 				continue;
 100:../SEMS_Sources/Main.c **** 			}
 101:../SEMS_Sources/Main.c **** 
 102:../SEMS_Sources/Main.c **** 			// Uknow request
 103:../SEMS_Sources/Main.c **** 			uint8_t buff[32] = {"Unknown request"};
 104:../SEMS_Sources/Main.c **** 			write_request(buff, sec_comm);
 105:../SEMS_Sources/Main.c **** 		}
 106:../SEMS_Sources/Main.c **** 		else
 107:../SEMS_Sources/Main.c **** 		{
 108:../SEMS_Sources/Main.c **** 			// Req before unlock || invalid Token, Nonce, Hash
 109:../SEMS_Sources/Main.c **** 
 110:../SEMS_Sources/Main.c **** 			failed_req++;
  57              	 .loc 1 110 0
  58 001a C346     	 mov fp,r8
  36:../SEMS_Sources/Main.c **** 	uint8_t sec_comm = false;
  59              	 .loc 1 36 0
  60 001c 3746     	 mov r7,r6
  61 001e 08AD     	 add r5,sp,#32
  62              	.LVL2:
  63              	.L2:
  56:../SEMS_Sources/Main.c **** 		{
  64              	 .loc 1 56 0
  65 0020 6846     	 mov r0,sp
  66 0022 3946     	 mov r1,r7
  67 0024 3246     	 mov r2,r6
  68 0026 FFF7FEFF 	 bl read_request
  69              	.LVL3:
  70 002a 0446     	 mov r4,r0
  71 002c 20BB     	 cbnz r0,.L3
  72              	.L20:
  73              	.LBB2:
  58:../SEMS_Sources/Main.c **** 			{
  74              	 .loc 1 58 0
  75 002e 99F80030 	 ldrb r3,[r9]
  76 0032 012B     	 cmp r3,#1
  77 0034 7CD0     	 beq .L15
  66:../SEMS_Sources/Main.c **** 			{
  78              	 .loc 1 66 0
  79 0036 9DF80030 	 ldrb r3,[sp]
  80 003a 552B     	 cmp r3,#85
  81 003c 00F08B80 	 beq .L16
  76:../SEMS_Sources/Main.c **** 			{
  82              	 .loc 1 76 0
  83 0040 432B     	 cmp r3,#67
  84 0042 00F08D80 	 beq .L17
  84:../SEMS_Sources/Main.c **** 			{
  85              	 .loc 1 84 0
  86 0046 4C2B     	 cmp r3,#76
  87 0048 00F08E80 	 beq .L18
  95:../SEMS_Sources/Main.c **** 			{
  88              	 .loc 1 95 0
  89 004c 412B     	 cmp r3,#65
  90 004e 59D0     	 beq .L19
 103:../SEMS_Sources/Main.c **** 			write_request(buff, sec_comm);
  91              	 .loc 1 103 0
  92 0050 9AE80F00 	 ldmia r10,{r0,r1,r2,r3}
  93 0054 85E80F00 	 stmia r5,{r0,r1,r2,r3}
 104:../SEMS_Sources/Main.c **** 		}
  94              	 .loc 1 104 0
  95 0058 3146     	 mov r1,r6
  96 005a 2846     	 mov r0,r5
 103:../SEMS_Sources/Main.c **** 			write_request(buff, sec_comm);
  97              	 .loc 1 103 0
  98 005c 0C94     	 str r4,[sp,#48]
  99 005e 0D94     	 str r4,[sp,#52]
 100 0060 0E94     	 str r4,[sp,#56]
 101 0062 0F94     	 str r4,[sp,#60]
 104:../SEMS_Sources/Main.c **** 		}
 102              	 .loc 1 104 0
 103 0064 FFF7FEFF 	 bl write_request
 104              	.LVL4:
 105              	.LBE2:
  56:../SEMS_Sources/Main.c **** 		{
 106              	 .loc 1 56 0
 107 0068 6846     	 mov r0,sp
 108 006a 3946     	 mov r1,r7
 109 006c 3246     	 mov r2,r6
 110 006e FFF7FEFF 	 bl read_request
 111              	.LVL5:
 112 0072 0446     	 mov r4,r0
 113 0074 0028     	 cmp r0,#0
 114 0076 DAD0     	 beq .L20
 115              	.L3:
 116              	 .loc 1 110 0
 117 0078 98F80030 	 ldrb r3,[r8]
 118 007c 0133     	 adds r3,r3,#1
 119 007e DBB2     	 uxtb r3,r3
 120 0080 88F80030 	 strb r3,[r8]
 111:../SEMS_Sources/Main.c **** 			if(cooldowned)
 121              	 .loc 1 111 0
 122 0084 99F80030 	 ldrb r3,[r9]
 123 0088 03F0FF0E 	 and lr,r3,#255
 124 008c 43BB     	 cbnz r3,.L21
 112:../SEMS_Sources/Main.c **** 			{
 113:../SEMS_Sources/Main.c **** 				uint8_t buff[32] = {"Denied by cooldown."};
 114:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
 115:../SEMS_Sources/Main.c **** 			}
 116:../SEMS_Sources/Main.c **** 			else
 117:../SEMS_Sources/Main.c **** 			{
 118:../SEMS_Sources/Main.c **** 				if(failed_req >= MAX_FAILED_REQ)
 125              	 .loc 1 118 0
 126 008e 9BF80030 	 ldrb r3,[fp]
 127 0092 03F0FF04 	 and r4,r3,#255
 128 0096 B3B1     	 cbz r3,.L12
 129              	.LBB6:
 119:../SEMS_Sources/Main.c **** 				{
 120:../SEMS_Sources/Main.c **** 					uint8_t buff[32] = {"Cooldown activated."};
 130              	 .loc 1 120 0 discriminator 7
 131 0098 DFF80CC1 	 ldr ip,.L22+20
 132 009c CDF834E0 	 str lr,[sp,#52]
 133 00a0 BCE80F00 	 ldmia ip!,{r0,r1,r2,r3}
 134 00a4 2C46     	 mov r4,r5
 135 00a6 0FC4     	 stmia r4!,{r0,r1,r2,r3}
 136 00a8 DCF80030 	 ldr r3,[ip]
 137 00ac 2360     	 str r3,[r4]
 121:../SEMS_Sources/Main.c **** 					optiga_lib_print_bytes(buff, 32);
 138              	 .loc 1 121 0 discriminator 7
 139 00ae 2846     	 mov r0,r5
 140 00b0 2021     	 movs r1,#32
 120:../SEMS_Sources/Main.c **** 					optiga_lib_print_bytes(buff, 32);
 141              	 .loc 1 120 0 discriminator 7
 142 00b2 CDF838E0 	 str lr,[sp,#56]
 143 00b6 CDF83CE0 	 str lr,[sp,#60]
 144              	 .loc 1 121 0 discriminator 7
 145 00ba FFF7FEFF 	 bl optiga_lib_print_bytes
 146              	.LVL6:
 122:../SEMS_Sources/Main.c **** 					cooldowned = true;
 147              	 .loc 1 122 0 discriminator 7
 148 00be 364A     	 ldr r2,.L22+4
 149 00c0 0123     	 movs r3,#1
 150 00c2 1370     	 strb r3,[r2]
 151              	.LBE6:
 152 00c4 ACE7     	 b .L2
 153              	.L12:
 154              	.LBB7:
 123:../SEMS_Sources/Main.c **** 				}
 124:../SEMS_Sources/Main.c **** 				else
 125:../SEMS_Sources/Main.c **** 				{
 126:../SEMS_Sources/Main.c **** 					// Just a wrong request
 127:../SEMS_Sources/Main.c **** 					uint8_t buff[32] = {"Request denied."};
 155              	 .loc 1 127 0 discriminator 8
 156 00c6 354B     	 ldr r3,.L22+8
 157 00c8 0C94     	 str r4,[sp,#48]
 158 00ca 0FCB     	 ldmia r3,{r0,r1,r2,r3}
 159 00cc 85E80F00 	 stmia r5,{r0,r1,r2,r3}
 128:../SEMS_Sources/Main.c **** 					optiga_lib_print_bytes(buff, 32);
 160              	 .loc 1 128 0 discriminator 8
 161 00d0 2846     	 mov r0,r5
 162 00d2 2021     	 movs r1,#32
 127:../SEMS_Sources/Main.c **** 					optiga_lib_print_bytes(buff, 32);
 163              	 .loc 1 127 0 discriminator 8
 164 00d4 0D94     	 str r4,[sp,#52]
 165 00d6 0E94     	 str r4,[sp,#56]
 166 00d8 0F94     	 str r4,[sp,#60]
 167              	 .loc 1 128 0 discriminator 8
 168 00da FFF7FEFF 	 bl optiga_lib_print_bytes
 169              	.LVL7:
 170 00de 9FE7     	 b .L2
 171              	.L21:
 172              	.LBE7:
 173              	.LBB8:
 113:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
 174              	 .loc 1 113 0 discriminator 6
 175 00e0 DFF8C8E0 	 ldr lr,.L22+24
 176 00e4 BEE80F00 	 ldmia lr!,{r0,r1,r2,r3}
 177 00e8 2C46     	 mov r4,r5
 178 00ea 0FC4     	 stmia r4!,{r0,r1,r2,r3}
 179 00ec DEF80030 	 ldr r3,[lr]
 180 00f0 2360     	 str r3,[r4]
 114:../SEMS_Sources/Main.c **** 			}
 181              	 .loc 1 114 0 discriminator 6
 182 00f2 2846     	 mov r0,r5
 113:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
 183              	 .loc 1 113 0 discriminator 6
 184 00f4 0023     	 movs r3,#0
 114:../SEMS_Sources/Main.c **** 			}
 185              	 .loc 1 114 0 discriminator 6
 186 00f6 2021     	 movs r1,#32
 113:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
 187              	 .loc 1 113 0 discriminator 6
 188 00f8 0D93     	 str r3,[sp,#52]
 189 00fa 0E93     	 str r3,[sp,#56]
 190 00fc 0F93     	 str r3,[sp,#60]
 114:../SEMS_Sources/Main.c **** 			}
 191              	 .loc 1 114 0 discriminator 6
 192 00fe FFF7FEFF 	 bl optiga_lib_print_bytes
 193              	.LVL8:
 194              	.LBE8:
 195 0102 8DE7     	 b .L2
 196              	.L19:
 197              	.LBB9:
 198              	.LBB3:
  97:../SEMS_Sources/Main.c **** 				write_request(buff, sec_comm);
 199              	 .loc 1 97 0
 200 0104 264B     	 ldr r3,.L22+12
 201 0106 93E80700 	 ldmia r3,{r0,r1,r2}
 202 010a 2B46     	 mov r3,r5
 203 010c 03C3     	 stmia r3!,{r0,r1}
 204 010e 23F8022B 	 strh r2,[r3],#2
 205 0112 4FEA124E 	 lsr lr,r2,#16
 206 0116 2146     	 mov r1,r4
 207 0118 0DF12B00 	 add r0,sp,#43
 208 011c 1522     	 movs r2,#21
 209 011e 83F800E0 	 strb lr,[r3]
 210 0122 FFF7FEFF 	 bl memset
 211              	.LVL9:
  98:../SEMS_Sources/Main.c **** 				continue;
 212              	 .loc 1 98 0
 213 0126 2846     	 mov r0,r5
 214 0128 3146     	 mov r1,r6
 215 012a FFF7FEFF 	 bl write_request
 216              	.LVL10:
 217 012e 77E7     	 b .L2
 218              	.L15:
 219              	.LBE3:
 220              	.LBB4:
  60:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
 221              	 .loc 1 60 0
 222 0130 DFF878C0 	 ldr ip,.L22+24
 223 0134 0D90     	 str r0,[sp,#52]
 224 0136 BCE80F00 	 ldmia ip!,{r0,r1,r2,r3}
 225 013a AE46     	 mov lr,r5
 226 013c AEE80F00 	 stmia lr!,{r0,r1,r2,r3}
 227 0140 DCF80030 	 ldr r3,[ip]
 228 0144 0E94     	 str r4,[sp,#56]
  61:../SEMS_Sources/Main.c **** 				continue;
 229              	 .loc 1 61 0
 230 0146 2846     	 mov r0,r5
 231 0148 2021     	 movs r1,#32
  60:../SEMS_Sources/Main.c **** 				optiga_lib_print_bytes(buff, 32);
 232              	 .loc 1 60 0
 233 014a 0F94     	 str r4,[sp,#60]
 234 014c CEF80030 	 str r3,[lr]
  61:../SEMS_Sources/Main.c **** 				continue;
 235              	 .loc 1 61 0
 236 0150 FFF7FEFF 	 bl optiga_lib_print_bytes
 237              	.LVL11:
 238 0154 64E7     	 b .L2
 239              	.L16:
 240              	.LBE4:
  70:../SEMS_Sources/Main.c **** 				continue;
 241              	 .loc 1 70 0
 242 0156 0646     	 mov r6,r0
 243              	.LVL12:
  69:../SEMS_Sources/Main.c **** 				sec_comm = 0;  // reset sec_comm flag
 244              	 .loc 1 69 0
 245 0158 FFF7FEFF 	 bl secure_unlock
 246              	.LVL13:
 247 015c 0746     	 mov r7,r0
 248              	.LVL14:
  71:../SEMS_Sources/Main.c **** 			}
 249              	 .loc 1 71 0
 250 015e 5FE7     	 b .L2
 251              	.LVL15:
 252              	.L17:
  78:../SEMS_Sources/Main.c **** 				continue;
 253              	 .loc 1 78 0
 254 0160 FFF7FEFF 	 bl secure_communication
 255              	.LVL16:
 256 0164 0646     	 mov r6,r0
 257              	.LVL17:
  79:../SEMS_Sources/Main.c **** 			}
 258              	 .loc 1 79 0
 259 0166 5BE7     	 b .L2
 260              	.L18:
 261              	.LBB5:
  86:../SEMS_Sources/Main.c **** 
 262              	 .loc 1 86 0
 263 0168 0A4B     	 ldr r3,.L22
 264 016a 93E80300 	 ldmia r3,{r0,r1}
 265 016e 1922     	 movs r2,#25
 266 0170 0B0C     	 lsrs r3,r1,#16
 267 0172 2860     	 str r0,[r5]
 268 0174 ADF82410 	 strh r1,[sp,#36]
 269 0178 0DF12700 	 add r0,sp,#39
 270 017c 2146     	 mov r1,r4
  90:../SEMS_Sources/Main.c **** 				continue;
 271              	 .loc 1 90 0
 272 017e 08AD     	 add r5,sp,#32
  86:../SEMS_Sources/Main.c **** 
 273              	 .loc 1 86 0
 274 0180 8DF82630 	 strb r3,[sp,#38]
 275 0184 FFF7FEFF 	 bl memset
 276              	.LVL18:
  90:../SEMS_Sources/Main.c **** 				continue;
 277              	 .loc 1 90 0
 278 0188 2846     	 mov r0,r5
 279 018a 3146     	 mov r1,r6
  88:../SEMS_Sources/Main.c **** 
 280              	 .loc 1 88 0
 281 018c 2746     	 mov r7,r4
  90:../SEMS_Sources/Main.c **** 				continue;
 282              	 .loc 1 90 0
 283 018e FFF7FEFF 	 bl write_request
 284              	.LVL19:
 285 0192 45E7     	 b .L2
 286              	.L23:
 287              	 .align 2
 288              	.L22:
 289 0194 20000000 	 .word .LANCHOR1+32
 290 0198 00000000 	 .word .LANCHOR0
 291 019c A0000000 	 .word .LANCHOR1+160
 292 01a0 40000000 	 .word .LANCHOR1+64
 293 01a4 00000000 	 .word .LANCHOR2
 294 01a8 80000000 	 .word .LANCHOR1+128
 295 01ac 00000000 	 .word .LANCHOR1
 296              	.LBE5:
 297              	.LBE9:
 298              	 .cfi_endproc
 299              	.LFE454:
 301              	 .global cooldowned
 302              	 .global failed_req
 303              	 .section .rodata
 304              	 .align 2
 305              	 .set .LANCHOR1,.+0
 306              	.LC0:
 307 0000 44656E69 	 .ascii "Denied by cooldown.\000"
 307      65642062 
 307      7920636F 
 307      6F6C646F 
 307      776E2E00 
 308 0014 00000000 	 .space 12
 308      00000000 
 308      00000000 
 309              	.LC1:
 310 0020 4C6F636B 	 .ascii "Locked\000"
 310      656400
 311 0027 00000000 	 .space 25
 311      00000000 
 311      00000000 
 311      00000000 
 311      00000000 
 312              	.LC2:
 313 0040 41414242 	 .ascii "AABBCCDEFG\000"
 313      43434445 
 313      464700
 314 004b 00000000 	 .space 21
 314      00000000 
 314      00000000 
 314      00000000 
 314      00000000 
 315              	.LC3:
 316 0060 556E6B6E 	 .ascii "Unknown request\000"
 316      6F776E20 
 316      72657175 
 316      65737400 
 317 0070 00000000 	 .space 16
 317      00000000 
 317      00000000 
 317      00000000 
 318              	.LC4:
 319 0080 436F6F6C 	 .ascii "Cooldown activated.\000"
 319      646F776E 
 319      20616374 
 319      69766174 
 319      65642E00 
 320 0094 00000000 	 .space 12
 320      00000000 
 320      00000000 
 321              	.LC5:
 322 00a0 52657175 	 .ascii "Request denied.\000"
 322      65737420 
 322      64656E69 
 322      65642E00 
 323 00b0 00000000 	 .space 16
 323      00000000 
 323      00000000 
 323      00000000 
 324              	 .section .bss.failed_req,"aw",%nobits
 325              	 .set .LANCHOR2,.+0
 328              	failed_req:
 329 0000 00       	 .space 1
 330              	 .section .bss.cooldowned,"aw",%nobits
 331              	 .set .LANCHOR0,.+0
 334              	cooldowned:
 335 0000 00       	 .space 1
 336              	 .text
 337              	.Letext0:
 338              	 .file 2 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 339              	 .file 3 "c:\\infineon\\tools\\dave ide\\4.5.0.202105191637\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 340              	 .file 4 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Infineon/XMC4800_series/Include/XMC4800.h"
 341              	 .file 5 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usic.h"
 342              	 .file 6 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usbd_regs.h"
 343              	 .file 7 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/XMCLib/inc/xmc_usbd.h"
 344              	 .file 8 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/USBD/usbd.h"
 345              	 .file 9 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Include/core_cm4.h"
 346              	 .file 10 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Libraries/CMSIS/Infineon/XMC4800_series/Include/system_XMC4800.h"
 347              	 .file 11 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/xmc4800_iot_kit/common/Dave/Generated/USBD/usbd_extern.h"
 348              	 .file 12 "../SEMS_Sources/../SEMS_Headers/Unlock.h"
 349              	 .file 13 "../SEMS_Sources/../SEMS_Headers/Com.h"
 350              	 .file 14 "D:/School/diseratie/SEMS/xmc4800_evaluation_kit/optiga-trust-m/optiga/include/optiga/common/optiga_lib_logger.h"
 351              	 .file 15 "../SEMS_Sources/../SEMS_Headers/Patcher.h"
 352              	 .file 16 "../SEMS_Sources/../SEMS_Headers/Timer.h"
DEFINED SYMBOLS
                            *ABS*:00000000 Main.c
    {standard input}:20     .text.my_optiga_shell_begin:00000000 $t
    {standard input}:25     .text.my_optiga_shell_begin:00000000 my_optiga_shell_begin
    {standard input}:289    .text.my_optiga_shell_begin:00000194 $d
    {standard input}:334    .bss.cooldowned:00000000 cooldowned
    {standard input}:328    .bss.failed_req:00000000 failed_req
    {standard input}:304    .rodata:00000000 $d
    {standard input}:329    .bss.failed_req:00000000 $d
    {standard input}:335    .bss.cooldowned:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
start_cooldown_timer
read_request
write_request
optiga_lib_print_bytes
memset
secure_unlock
secure_communication
